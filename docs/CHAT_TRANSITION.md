markdown
# üìò –ü–ê–°–ü–û–†–¢ –ü–†–û–ï–ö–¢–ê: –£–º–Ω—ã–π –¥–æ–º –Ω–∞ ESP-NOW

> **–î–∞—Ç–∞ –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏:** 2025-04-10  
> **–í–µ—Ä—Å–∏—è —Å–∏—Å—Ç–µ–º—ã:** 2.5 (—Å —Å–∏—Å—Ç–µ–º–æ–π –æ—Ö—Ä–∞–Ω—ã)  
> **–°—Ç–∞—Ç—É—Å:** üü¢ –í —Ä–∞–±–æ—á–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã.

## üèÜ –¶–ï–õ–¨ –ü–†–û–ï–ö–¢–ê
–°–æ–∑–¥–∞—Ç—å **–º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—É—é, –∞–≤—Ç–æ–Ω–æ–º–Ω—É—é —Å–∏—Å—Ç–µ–º—É —É–º–Ω–æ–≥–æ –¥–æ–º–∞** –Ω–∞ –±–∞–∑–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ **ESP-NOW**. –°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —Ö–∞–±–∞ —Å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –∏ –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã—Ö —É–∑–ª–æ–≤ —Å –¥–∞—Ç—á–∏–∫–∞–º–∏ –∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏.

## ‚úÖ –ß–¢–û –†–ê–ë–û–¢–ê–ï–¢ –°–ï–ô–ß–ê–° (–í–µ—Ä—Å–∏—è 2.5)

### üéØ –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
- **–•–∞–± (ESP32):** –í–µ–±-—Å–µ—Ä–≤–µ—Ä, —Ç–æ—á–∫–∞ –¥–æ—Å—Ç—É–ø–∞ (`SmartHome-Hub`), —à–ª—é–∑ ESP-NOW.
- **–£–∑–µ–ª "–ú–∞—Å—Ç–µ—Ä—Å–∫–∞—è" (ESP32-C3):**
    - üìä **–î–∞—Ç—á–∏–∫–∏:** AHT20 (—Ç–µ–º–ø./–≤–ª–∞–∂.), BMP280 (—Ç–µ–º–ø./–¥–∞–≤–ª.).
    - üîí **–û—Ö—Ä–∞–Ω–∞:** –î–≤–∞ –∫–æ–Ω—Ü–µ–≤–∏–∫–∞ –Ω–∞ **GPIO3, GPIO4**. –¢—Ä–µ–≤–æ–≥–∞ –ø—Ä–∏ **—Ä–∞–∑—Ä—ã–≤–µ** –Ω–æ—Ä–º–∞–ª—å–Ω–æ-–∑–∞–º–∫–Ω—É—Ç–æ–π —Ü–µ–ø–∏.
    - üí° **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –°–≤–µ—Ç–æ–¥–∏–æ–¥ –Ω–∞ GPIO8.
- **–£–∑–µ–ª "–¢–µ–ø–ª–∏—Ü–∞" (ESP8266):** –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–ª–∞–∂–Ω–æ—Å—Ç—å, —Å—Ç–∞—Ç—É—Å —Ä–µ–ª–µ (–±–∏–Ω–∞—Ä–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª).
- **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:** –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π –¥–∏–∑–∞–π–Ω, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, **–∞—É–¥–∏–æ- –∏ –≤–∏–±—Ä–æ-—Ç—Ä–µ–≤–æ–≥–∞** –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ –æ—Ö—Ä–∞–Ω—ã.

### üì° –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:
- **–°–≤—è–∑—å:** ESP-NOW (—Å—Ç–∞–±–∏–ª—å–Ω–∞—è, –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è).
- **–ü—Ä–æ—Ç–æ–∫–æ–ª:** –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `esp_now_message` —Å –ø–æ–ª–µ–º `json[192]`.
- **–í–µ–±:** ESPAsyncWebServer + WebSocket.

## üó∫Ô∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –í –¶–ò–§–†–ê–•
| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ü–ª–∞—Ç–∞ | –†–æ–ª—å | –ö–ª—é—á–µ–≤–æ–π MAC |
|-----------|-------|------|--------------|
| **–•–∞–±** | ESP32 | –®–ª—é–∑, –≤–µ–±-—Å–µ—Ä–≤–µ—Ä | `9C:9C:1F:C7:2D:94` |
| **–ú–∞—Å—Ç–µ—Ä—Å–∫–∞—è** | ESP32-C3 | –î–∞—Ç—á–∏–∫–∏, –æ—Ö—Ä–∞–Ω–∞ | `AC:EB:E6:49:10:28` |
| **–¢–µ–ø–ª–∏—Ü–∞** | ESP8266 | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–µ–ø–ª–∏—Ü—ã | `E8:9F:6D:87:34:8A` |

**–†–µ–∂–∏–º—ã Wi-Fi:**
- –•–∞–±: `WIFI_AP_STA` (STA –¥–ª—è ESP-NOW, AP –¥–ª—è –≤–µ–±–∞).
- –£–∑–ª—ã: `WIFI_STA`.

## üîß –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢ –î–õ–Ø –†–ê–ó–†–ê–ë–û–¢–ß–ò–ö–ê

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–∫—Ä—ã—Ç–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
```bash
git clone https://github.com/varikapk-a11y/SmartHome_ESP-NOW.git
# –û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç—ã PlatformIO –ü–û –û–¢–î–ï–õ–¨–ù–û–°–¢–ò:
#   - `firmware/Hub/`
#   - `firmware/Node/`
2. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
–î–ª—è ESP32-C3 (–£–∑–µ–ª): –í platformio.ini –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω —Ñ–ª–∞–≥ -DARDUINO_USB_CDC_ON_BOOT=1 –¥–ª—è —Ä–∞–±–æ—Ç—ã Serial.

MAC-–∞–¥—Ä–µ—Å–∞: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –∫–æ–¥–µ —É–∑–ª–∞ –ø—Ä–æ–ø–∏—Å–∞–Ω STA MAC —Ö–∞–±–∞ (9C:9C:1F:C7:2D:94).

3. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (—Å—Ö–µ–º—ã)
–ö–æ–Ω—Ü–µ–≤–∏–∫–∏ (–û—Ö—Ä–∞–Ω–∞): –ü–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è –ø–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ-–∑–∞–º–∫–Ω—É—Ç–æ–π —Å—Ö–µ–º–µ: GPIO -> –∫–æ–Ω—Ü–µ–≤–∏–∫ -> GND.

–†–∞–∑—Ä—ã–≤ —Ü–µ–ø–∏ = HIGH = –¢—Ä–µ–≤–æ–≥–∞.

–ó–∞–º–∫–Ω—É—Ç–∞—è —Ü–µ–ø—å = LOW = –ù–æ—Ä–º–∞.

–î–∞—Ç—á–∏–∫–∏ (I2C): GPIO0 (SCL), GPIO1 (SDA), –∞–¥—Ä–µ—Å–∞: AHT20 (0x38), BMP280 (0x76).

4. –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
–ü—Ä–æ—à–µ–π—Ç–µ —Ö–∞–±, –∑–∞—Ç–µ–º —É–∑–µ–ª.

–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ Wi-Fi SmartHome-Hub (–ø–∞—Ä–æ–ª—å: 12345678).

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ 192.168.4.1.

–ù–∞–∂–º–∏—Ç–µ "–û–ë–ù–û–í–ò–¢–¨" –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

üìÅ –ê–ö–¢–£–ê–õ–¨–ù–´–ï –°–°–´–õ–ö–ò –ù–ê –ö–û–î –ò –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ
–í–∞–∂–Ω–æ: –ü–µ—Ä–µ–¥ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è–º–∏ –≤—Å–µ–≥–¥–∞ —Å–≤–µ—Ä—è–π—Ç–µ—Å—å —Å PROJECT_BASELINE.md (–≤–µ—Ä—Å–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫).

–ö–æ–¥ —Ö–∞–±–∞ (–í–µ—Ä—Å–∏—è 2.5): firmware/Hub/src/main.cpp

–ö–æ–¥ —É–∑–ª–∞ (—Å –æ—Ö—Ä–∞–Ω–æ–π): firmware/Node/src/main.cpp

–ü–æ–ª–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –≤–µ—Ä—Å–∏–∏: docs/PROJECT_BASELINE.md

–ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è: docs/ROADMAP.md

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Å—Ä–µ–¥—ã: docs/DEVELOPMENT_SETUP.md

üöÄ –ö–û–ù–¢–ï–ö–°–¢ –î–õ–Ø –ü–†–û–î–û–õ–ñ–ï–ù–ò–Ø –†–ê–ó–†–ê–ë–û–¢–ö–ò
–ü—Ä–æ–µ–∫—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–±–æ—á–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏. –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ ROADMAP.md (–í–µ—Ä—Å–∏—è 0.4 –∏ –¥–∞–ª–µ–µ).

–ë–ª–∏–∂–∞–π—à–∏–µ –ª–æ–≥–∏—á–Ω—ã–µ —à–∞–≥–∏ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ):

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –∑–≤—É–∫–∞ —Ç—Ä–µ–≤–æ–≥–∏ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ.

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∞ —Å–æ–±—ã—Ç–∏–π (–∏—Å—Ç–æ—Ä–∏–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π –æ—Ö—Ä–∞–Ω—ã).

–£–ª—É—á—à–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (PWA).

üíé –ö–†–ê–¢–ö–ê–Ø –ò–°–¢–û–†–ò–Ø –ü–†–ò–ù–Ø–¢–´–• –†–ï–®–ï–ù–ò–ô
(–î–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –≤—ã–±–æ—Ä–æ–≤ –∏ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º)

–ü—Ä–æ–±–ª–µ–º–∞ / –í–æ–ø—Ä–æ—Å	–ü—Ä–∏–Ω—è—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ	–†–µ–∑—É–ª—å—Ç–∞—Ç
–ö–æ–Ω—Ñ–ª–∏–∫—Ç MAC –≤ —Ä–µ–∂–∏–º–µ WIFI_AP	–•–∞–± –ø–µ—Ä–µ–≤–µ–¥—ë–Ω –≤ —Ä–µ–∂–∏–º WIFI_AP_STA. ESP-NOW —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ STA-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (MAC: ...94), –≤–µ–± ‚Äî —á–µ—Ä–µ–∑ AP.	–°—Ç–∞–±–∏–ª—å–Ω–∞—è –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–≤—è–∑—å ESP-NOW –ø—Ä–∏ —Ä–∞–±–æ—Ç–∞—é—â–µ–º –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–µ.
–ù–µ—Ç –≤—ã–≤–æ–¥–∞ –≤ Serial Monitor –Ω–∞ ESP32-C3	–î–æ–±–∞–≤–ª–µ–Ω —Ñ–ª–∞–≥ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ -DARDUINO_USB_CDC_ON_BOOT=1 –≤ platformio.ini —É–∑–ª–∞.	–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏ —á–µ—Ä–µ–∑ USB.
–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –∫–æ–Ω—Ü–µ–≤–∏–∫–æ–≤	–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–∂–∏–º INPUT_PULLUP. –ù–æ—Ä–º–∞–ª—å–Ω–æ-–∑–∞–º–∫–Ω—É—Ç–∞—è —Ü–µ–ø—å: —Ä–∞–∑—Ä—ã–≤ = HIGH = —Ç—Ä–µ–≤–æ–≥–∞.	–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å—Ö–µ–º–∞: –æ–±—Ä—ã–≤ –ø—Ä–æ–≤–æ–¥–∞ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ç—Ä–µ–≤–æ–≥–µ.
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ—Ö—Ä–∞–Ω—ã –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å	–û—Ö—Ä–∞–Ω–∞ –≤—Å—Ç—Ä–æ–µ–Ω–∞ –≤ —Å–µ–∫—Ü–∏—é "–ú–∞—Å—Ç–µ—Ä—Å–∫–∞—è". –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∞—É–¥–∏–æ/–≤–∏–±—Ä–æ-—Ç—Ä–µ–≤–æ–≥–∞ —á–µ—Ä–µ–∑ Web Audio API.	–ö–æ–º–ø–∞–∫—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞ Android.
üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –Ω–æ–≤–æ–≥–æ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞:
–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–∞. –ö–æ–¥ –≤ firmware/ –∞–∫—Ç—É–∞–ª–µ–Ω. –ü—Ä–∏ –≤–Ω–µ—Å–µ–Ω–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–æ–±–ª—é–¥–∞–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã JSON –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞. –£–¥–∞—á–∏ –≤ —Ä–∞–∑–≤–∏—Ç–∏–∏!

text

## üõ†Ô∏è –ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1.  **–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª** `docs/CHAT_TRANSITION.md` –≤ –≤–∞—à–µ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –∫–æ–¥–∞ (VSCode).
2.  **–í–´–î–ï–õ–ò–¢–ï –í–ï–°–¨ —Ç–µ–∫—Å—Ç** –≤ —Ñ–∞–π–ª–µ (Ctrl+A).
3.  **–£–î–ê–õ–ò–¢–ï** –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç.
4.  **–í–°–¢–ê–í–¨–¢–ï** —Ç–µ–∫—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π —è –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª –≤—ã—à–µ (Ctrl+V).
5.  **–°–û–•–†–ê–ù–ò–¢–ï** —Ñ–∞–π–ª (Ctrl+S).

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª —Å—Ç–∞–Ω–µ—Ç **—á–∏—Å—Ç—ã–º, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º** –¥–æ–∫—É–º–µ–Ω—Ç–æ–º, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–ª—å–Ω–æ –ø–æ–º–æ–∂–µ—Ç –ª—é–±–æ–º—É —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É –±—ã—Å—Ç—Ä–æ –≤–æ–π—Ç–∏ –≤ –ø—Ä–æ–µ–∫—Ç.