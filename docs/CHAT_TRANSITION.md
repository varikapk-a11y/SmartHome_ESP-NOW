# üöÄ –ü–ï–†–ï–•–û–î –ú–ï–ñ–î–£ –ß–ê–¢–ê–ú–ò: –ö–û–ù–¢–ï–ö–°–¢ –î–õ–Ø –ü–†–û–î–û–õ–ñ–ï–ù–ò–Ø

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-04-10
**–ü–æ—Å–ª–µ–¥–Ω–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π —á–∞—Ç:** –ü—Ä–µ—Ä–≤–∞–Ω –Ω–∞ –æ–±—Å—É–∂–¥–µ–Ω–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–≤—è–∑–∏ ESP-NOW.
**–¶–µ–ª—å —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞:** –û–±–µ—Å–ø–µ—á–∏—Ç—å –±–µ—Å–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏ —Å AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º.

---

## üîç –°–í–û–î–ö–ê –¢–ï–ö–£–©–ï–ô –°–ò–¢–£–ê–¶–ò–ò

### ‚úÖ –ß–¢–û –†–ê–ë–û–¢–ê–ï–¢ (—Å—Ç–∞–±–∏–ª—å–Ω–æ)
1.  **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è `firmware/Hub` –∏ `firmware/Node` –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ PlatformIO.
2.  **–£–∑–µ–ª (ESP32-C3):**
    - –ß—Ç–µ–Ω–∏–µ –¥–∞—Ç—á–∏–∫–æ–≤ AHT20 –∏ BMP280 (–±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Adafruit).
    - –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ JSON: `{"node":101,"sensor":"AHT20+BMP280","AHT20":{"temp":...,"hum":...},"BMP280":{"temp":...,"press_mmHg":...}}`.
    - MAC —É–∑–ª–∞: `AC:EB:E6:49:10:28`.
3.  **–•–∞–± (ESP32):** –í–µ–±-—Å–µ—Ä–≤–µ—Ä (ESPAsyncWebServer) –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è.

### ‚ùå –ì–õ–ê–í–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê
**–°–≤—è–∑—å ESP-NOW –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.** –£–∑–µ–ª –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫—É `[–û–®–ò–ë–ö–ê] –û—Ç–ø—Ä–∞–≤–∫–∏: 12390` (ESP_ERR_ESPNOW_NOT_INIT).

#### üéØ –ö–û–†–ï–ù–ù–´–ï –ü–†–ò–ß–ò–ù–´ (–í–´–Ø–í–õ–ï–ù–´):
1.  **–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ MAC-–∞–¥—Ä–µ—Å–æ–≤:**
    - **–ö–æ–¥ —É–∑–ª–∞** (`Node/src/main.cpp`): `hubMacAddress[] = {0x9C, 0x9C, 0x1F, 0xC7, 0x2D, 0x94}`.
    - **–í –ª–æ–≥–∞—Ö —Ö–∞–±–∞:** `MAC-–∞–¥—Ä–µ—Å —Ö–∞–±–∞: 9C:9C:1F:C7:2D:95` (AP MAC –≤ —Ä–µ–∂–∏–º–µ `WIFI_AP`).
    - **–í—ã–≤–æ–¥:** –£–∑–µ–ª —à–ª–µ—Ç –Ω–∞ `...94`, —Ö–∞–± "—Å–ª—É—à–∞–µ—Ç" –Ω–∞ `...95`.

2.  **–ö–æ–Ω—Ñ–ª–∏–∫—Ç —Ä–µ–∂–∏–º–æ–≤ Wi-Fi:**
    - **–£–∑–µ–ª:** –†–µ–∂–∏–º `WIFI_STA` (—Å—Ç–∞–Ω—Ü–∏—è).
    - **–•–∞–± (–≤ –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ—à–∏–≤–∫–µ):** –†–µ–∂–∏–º `WIFI_AP` –∏–ª–∏ `WIFI_AP_STA` (–¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞).
    - **–í–∞–∂–Ω–æ:** –ü—Ä–∏ `WIFI_AP`/`WIFI_AP_STA` ESP32 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **AP MAC-–∞–¥—Ä–µ—Å** –¥–ª—è ESP-NOW, —á—Ç–æ –∏ –ø—Ä–∏–≤–µ–ª–æ –∫ —Å–º–µ–Ω–µ —Å `...94` –Ω–∞ `...95`.

3.  **–§–æ–Ω–æ–≤—ã–π —à—É–º:** –•–∞–± –≤–∏–¥–∏—Ç –ø–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (`E8:9F:6D:87:34:8A`), —á—Ç–æ –¥–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É ESP-NOW, –Ω–æ –Ω–µ–≤–µ—Ä–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É –ø–∏—Ä–∏–Ω–≥–∞.

---

## üìã –¢–û–ß–ö–ò –ü–†–ò–ù–Ø–¢–ò–Ø –†–ï–®–ï–ù–ò–ô (–°–†–û–ß–ù–û)

**–ü–µ—Ä–µ–¥ –ª—é–±—ã–º–∏ –¥–µ–π—Å—Ç–≤–∏—è–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–±—Ä–∞—Ç—å –æ–¥–∏–Ω –ø—É—Ç—å:**

### –í–û–ü–†–û–° 1: –ö–æ–Ω–µ—á–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ö–∞–±–∞?
-   **–í–∞—Ä–∏–∞–Ω—Ç A (–¢–æ–ª—å–∫–æ —Å–≤—è–∑—å):** –•–∞–± –≤ `WIFI_STA`. **–ù–µ—Ç –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è ESP-NOW —Å–≤—è–∑—å. –ù—É–∂–µ–Ω –¥—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–± –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (Serial).
-   **–í–∞—Ä–∏–∞–Ω—Ç B (–°–≤—è–∑—å + –í–µ–±):** –•–∞–± –≤ `WIFI_AP_STA`. ESP-NOW —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ **STA –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (MAC: ...94)**, –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ‚Äî —á–µ—Ä–µ–∑ **AP –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (MAC: ...95)**. –¢—Ä–µ–±—É–µ—Ç –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

### –í–û–ü–†–û–° 2: –ö–∞–∫–æ–π MAC –ø—Ä–æ–ø–∏—Å–∞—Ç—å –≤ –∫–æ–¥–µ —É–∑–ª–∞?
-   –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –û—Ç–≤–µ—Ç–∞ 1.
-   **–ï—Å–ª–∏ –í–∞—Ä–∏–∞–Ω—Ç A (`WIFI_STA`):** MAC = `...94` (STA MAC —Ö–∞–±–∞). –ù—É–∂–Ω–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –µ–≥–æ, –¥–æ–±–∞–≤–∏–≤ `Serial.println("STA MAC: " + WiFi.macAddress());` –≤ –∫–æ–¥ —Ö–∞–±–∞.
-   **–ï—Å–ª–∏ –í–∞—Ä–∏–∞–Ω—Ç B (`WIFI_AP_STA`):** MAC = `...94` (STA MAC —Ö–∞–±–∞). –¢–æ—Ç –∂–µ —Å–∞–º—ã–π.

**üëâ –†–ï–®–ï–ù–ò–ï –ü–û –£–ú–û–õ–ß–ê–ù–ò–Æ –î–õ–Ø –ü–†–û–î–û–õ–ñ–ï–ù–ò–Ø:**
–ù–∞—á–∞—Ç—å —Å **–í–∞—Ä–∏–∞–Ω—Ç–∞ A** –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–≤—è–∑–∏. –ü–æ—Å–ª–µ —É—Å–ø–µ—Ö–∞ –ø–µ—Ä–µ–π—Ç–∏ –∫ –í–∞—Ä–∏–∞–Ω—Ç—É B.

---

## üõ†Ô∏è –ì–û–¢–û–í–´–ï –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

–ö–∞–∫ —Ç–æ–ª—å–∫–æ –≤ –Ω–æ–≤–æ–º —á–∞—Ç–µ –±—É–¥–µ—Ç –ø—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º –≤—ã—à–µ, –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É –≤—ã–ø–æ–ª–Ω–∏—Ç—å:

### –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω –í–∞—Ä–∏–∞–Ω—Ç A (WIFI_STA):
1.  **–ó–∞–º–µ–Ω–∏—Ç—å `firmware/Hub/src/main.cpp`** –Ω–∞ –∫–æ–¥, –≥–¥–µ:
    - `WiFi.mode(WIFI_STA);`
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤—ã–≤–æ–¥ `STA MAC` –≤ Serial.
    - **–í–µ–±-—Å–µ—Ä–≤–µ—Ä –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç** (–∏–ª–∏ –∑–∞–≥–ª—É—à–µ–Ω).
2.  **–û–±–Ω–æ–≤–∏—Ç—å `hubMacAddress[]` –≤ `firmware/Node/src/main.cpp`** –Ω–∞ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π STA MAC.
3.  –ü—Ä–æ—à–∏—Ç—å, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤—è–∑—å.

### –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω –í–∞—Ä–∏–∞–Ω—Ç B (WIFI_AP_STA):
1.  **–ó–∞–º–µ–Ω–∏—Ç—å `firmware/Hub/src/main.cpp`** –Ω–∞ –∫–æ–¥, –≥–¥–µ:
    - `WiFi.mode(WIFI_AP_STA);`
    - `WiFi.softAP("Hub-Name", "password");` // –î–ª—è –≤–µ–±–∞
    - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤—ã–≤–æ–¥ **–ò STA, –ò AP MAC** –≤ Serial.
    - –í–µ–±-—Å–µ—Ä–≤–µ—Ä —Å–ª—É—à–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–∑ AP —Å–µ—Ç–∏.
    - ESP-NOW –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ STA –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.
2.  **–û–±–Ω–æ–≤–∏—Ç—å `hubMacAddress[]` –≤ –∫–æ–¥–µ —É–∑–ª–∞** –Ω–∞ **STA MAC** —Ö–∞–±–∞ (–Ω–µ AP MAC!).
3.  –ü—Ä–æ—à–∏—Ç—å, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ —Å–≤—è–∑—å, –∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

---

## üìÅ –°–°–´–õ–ö–ò –ù–ê –í–ê–ñ–ù–´–ï –§–ê–ô–õ–´

-   **–ê–∫—Ç—É–∞–ª—å–Ω—ã–π –∫–æ–¥ —É–∑–ª–∞:** [`firmware/Node/src/main.cpp`](https://github.com/varikapk-a11y/SmartHome_ESP-NOW/blob/main/firmware/Node/src/main.cpp)
-   **–ê–∫—Ç—É–∞–ª—å–Ω—ã–π –∫–æ–¥ —Ö–∞–±–∞ (—Ç—Ä–µ–±—É–µ—Ç –∑–∞–º–µ–Ω—ã):** [`firmware/Hub/src/main.cpp`](https://github.com/varikapk-a11y/SmartHome_ESP-NOW/blob/main/firmware/Hub/src/main.cpp)
-   **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏ (Node):** [`firmware/Node/platformio.ini`](https://github.com/varikapk-a11y/SmartHome_ESP-NOW/blob/main/firmware/Node/platformio.ini)
-   **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏ (Hub):** [`firmware/Hub/platformio.ini`](https://github.com/varikapk-a11y/SmartHome_ESP-NOW/blob/main/firmware/Hub/platformio.ini)
-   **–û–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:** [`docs/PROJECT_BASELINE.md`](https://github.com/varikapk-a11y/SmartHome_ESP-NOW/blob/main/docs/PROJECT_BASELINE.md)
-   **–ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è:** [`docs/ROADMAP.md`](https://github.com/varikapk-a11y/SmartHome_ESP-NOW/blob/main/docs/ROADMAP.md)

---

## üí¨ –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –î–õ–Ø –ù–û–í–û–ì–û –ê–°–°–ò–°–¢–ï–ù–¢–ê

–ü—Ä–∏–≤–µ—Ç! –≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç ‚Äî —Å–∏—Å—Ç–µ–º–∞ —É–º–Ω–æ–≥–æ –¥–æ–º–∞ –Ω–∞ ESP-NOW. –ú—ã –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∏—Å—å –Ω–∞ —Å–∞–º–æ–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–º –º–µ—Å—Ç–µ: –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ –ø—Ä–∏—á–∏–Ω—É –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Å–≤—è–∑–∏ (–∫–æ–Ω—Ñ–ª–∏–∫—Ç MAC/—Ä–µ–∂–∏–º–æ–≤ Wi-Fi) –∏ –≥–æ—Ç–æ–≤—ã –µ—ë –∏—Å–ø—Ä–∞–≤–∏—Ç—å.

**–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤ –Ω–∞—á–∞–ª–µ –Ω–æ–≤–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞:**
1.  –ü—Ä–æ—á—Ç–∏ —ç—Ç–æ—Ç —Ñ–∞–π–ª (`CHAT_TRANSITION.md`).
2.  –°–ø—Ä–æ—Å–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è **–æ—Ç–≤–µ—Ç—ã –Ω–∞ "–¢–æ—á–∫–∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π"** –≤—ã—à–µ.
3.  –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ ‚Äî —Å—Ä–∞–∑—É –ø—Ä–µ–¥–ª–æ–∂–∏ **–ø–æ–ª–Ω—ã–π, –≥–æ—Ç–æ–≤—ã–π –∫ —Å–±–æ—Ä–∫–µ –∫–æ–¥** –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞.

–£–¥–∞—á–∏! –°–∏—Å—Ç–µ–º–∞ –ø–æ—á—Ç–∏ –∑–∞—Ä–∞–±–æ—Ç–∞–ª–∞.
